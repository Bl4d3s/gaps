import{getOwnedMoviesForTable}from"/js/modules/common.min.js";let libraryTitle,noMovieContainer,movieContainer,movieSearchingContainer,plexServers,plexServer,moviesTable,libraryKey;function switchPlexLibrary(machineIdentifier,key){libraryKey=key;const plexLibrary=(plexServer=plexServers[machineIdentifier]).plexLibraries.find(plexServer=>plexServer.key===parseInt(key));libraryTitle.text(`${plexServer.friendlyName} - ${plexLibrary.title}`),moviesTable.data().clear(),moviesTable.rows().invalidate().draw(),getOwnedMoviesForTable(`/libraries/${machineIdentifier}/${libraryKey}`,movieContainer,noMovieContainer,moviesTable)}function searchForMovies(){movieSearchingContainer.show(),noMovieContainer.css({display:"none"}),moviesTable.data().clear(),moviesTable.rows().invalidate().draw(),$.ajax({type:"GET",url:`/plex/movies/${plexServer.machineIdentifier}/${libraryKey}`,contentType:"application/json",success:function(data){movieSearchingContainer.css({display:"none"}),moviesTable.rows.add(data).draw(),movieContainer.show(100)}})}jQuery(function($){Handlebars.registerHelper("json",function(context){return JSON.stringify(context)}),libraryTitle=$("#libraryTitle"),noMovieContainer=$("#noMovieContainer"),movieContainer=$("#movieContainer"),movieSearchingContainer=$("#movieSearchingContainer"),plexServers=JSON.parse($("#plexServers").val()),plexServer=JSON.parse($("#plexServer").val()),libraryKey=$("#libraryKey").val(),moviesTable=$("#movies").DataTable({deferRender:!0,ordering:!1,columns:[{data:"imdbId"},{data:"name"},{data:"year"},{data:"language"},{data:"overview"}],columnDefs:[{targets:[0],type:"html",searchable:!1,render:function(data,type,row){if("display"===type){row.address=plexServer.address,row.port=plexServer.port,row.plexToken=plexServer.plexToken;const plexServerCard=$("#movieCard").html();return Handlebars.compile(plexServerCard)(row)}return""}},{targets:[1,2,3,4],visible:!1}]}),getOwnedMoviesForTable(`/libraries/${plexServer.machineIdentifier}/${libraryKey}`,movieContainer,noMovieContainer,moviesTable),window.searchForMovies=searchForMovies,window.switchPlexLibrary=switchPlexLibrary});